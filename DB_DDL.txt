/* TABLE */
CREATE TABLE "USERS" 
(
    "USER_ID" NUMBER(6,0) PRIMARY KEY, 
    "EMAIL" VARCHAR2(255 BYTE) NOT NULL UNIQUE, 
    "PASSWORD" VARCHAR2(64 BYTE) NOT NULL, 
    "USERNAME" VARCHAR2(50 BYTE) NOT NULL, 
    "PHONE_NUMBER" VARCHAR2(15 BYTE), 
    "REGDATE" TIMESTAMP (6) DEFAULT sysdate NOT NULL
);
/
CREATE TABLE "GROUPS" 
(
    "GROUP_ID" NUMBER(6,0) PRIMARY KEY, 
    "USER_ID" NUMBER(6,0) NOT NULL, 
    "GROUP_NAME" VARCHAR2(30 BYTE) NOT NULL, 
    CONSTRAINT "FK_USER_GROUP" FOREIGN KEY ("USER_ID")
        REFERENCES "USERS" ("USER_ID") ON DELETE CASCADE
);
/
CREATE TABLE "CONTACTS" 
(
    "CONTACT_ID" NUMBER(6,0) PRIMARY KEY, 
    "USER_ID" NUMBER(6,0) NOT NULL, 
    "PHONE_NUMBER" VARCHAR2(15 BYTE) NOT NULL, 
    "NAME" VARCHAR2(50 BYTE) NOT NULL, 
    "GROUP_ID" NUMBER(6,0), 
    "MEMO" VARCHAR2(2000 BYTE), 
    "FAVORITES" NUMBER(1,0) DEFAULT 0 NOT NULL, 
    CONSTRAINT "FK_CONTACT_USER" FOREIGN KEY ("USER_ID")
        REFERENCES "USERS" ("USER_ID") ON DELETE CASCADE, 
    CONSTRAINT "FK_CONTACT_GROUP" FOREIGN KEY ("GROUP_ID")
        REFERENCES "GROUPS" ("GROUP_ID") ON DELETE SET NULL
);
/
/* SEQUENCE */
CREATE SEQUENCE "USER_SEQ"
START WITH 1
INCREMENT BY 1
NOCACHE
NOCYCLE;
/
CREATE SEQUENCE "GROUP_SEQ"
START WITH 1
INCREMENT BY 1
NOCACHE
NOCYCLE;
/
CREATE SEQUENCE "CONTACT_SEQ"
START WITH 1
INCREMENT BY 1
NOCACHE
NOCYCLE;
/
/* TRIGGER */
CREATE OR REPLACE TRIGGER "USER_BEFORE_INSERT" 
BEFORE INSERT ON "USERS"
FOR EACH ROW
BEGIN
    :NEW."USER_ID" := "USER_SEQ".NEXTVAL;
END;
/
CREATE OR REPLACE TRIGGER "GROUP_BEFORE_INSERT" 
BEFORE INSERT ON "GROUPS"
FOR EACH ROW
BEGIN
    :NEW."GROUP_ID" := "GROUP_SEQ".NEXTVAL;
END;
/
CREATE OR REPLACE TRIGGER "CONTACT_BEFORE_INSERT" 
BEFORE INSERT ON "CONTACTS"
FOR EACH ROW
BEGIN
    :NEW."CONTACT_ID" := "CONTACT_SEQ".NEXTVAL;
END;
/